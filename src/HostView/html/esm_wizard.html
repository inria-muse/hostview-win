 <!DOCTYPE html>
  <html>
    <head>
      <!--Import materialize.css-->
      <link type="text/css" rel="stylesheet" href="css/materialize.min.css"  media="screen,projection"/>

      <!--Let browser know website is optimized for mobile-->
      <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no"/>
  
	 <style>
	 
		div.tagsinput
		{
			border:none !important;
		}
		
		div.tagsinput span.tag
		{
			cursor:pointer;
			color: #0c0c0c !important;
			border: 1px solid #e0e0e0 !important;
			background:#f8f8f8 !important;
		}
		
		div.tagsinput span.tag a
		{
			color: #0c0c0c !important;
			font-size:0px !important;
		}
		
		div.tagsinput span.active
		{
			background:#cde69c !important;
			border: 1px solid #a5d24a !important;
			color: #638421 !important;
		}
		
		div.tagsinput span.active a
		{
			color: #82ad2b !important;
		}
		
		#categories_tag,
		#issues_tag,
		#pcissues_tag
		{
			width:200px !important;
		}
		
		#selections_tagsinput
		{
			margin-top:-12px;
		}
		
		#selections_tagsinput span.tag a
		{
			color: #0c0c0c !important;
			font-size:11px !important;
		}
		
		.hidden
		{
			display: none;
		}
		
		* 
		{
		    margin:0;
		    padding:0;
		}
		
        html,body
        {
            height:100%;
        }
        
        #allui
        {
            padding:10px;
        }
        
        html
        {
            background: #424242;
        }
        
        body
        {
            background:#ffffff;
			overflow:hidden;
        }
        .tab-container
        {
           float: left;
           margin: 0 0 0 0;
           width: 201px;
		   z-index:1;
        }
        .tab-container ul
        {
           list-style: none;
           text-align: center;
        }
        .tab-container ul li
        {
           border-top: 1px solid #e0e0e0;
           border-right: 1px solid #e0e0e0;
           border-bottom: 1px solid #e0e0e0;
		   border-left: 1px solid #e0e0e0;
		   
           background-color: #f8f8f8;
		   color: #888888;
		   
           margin: -1px 0;
           text-decoration: none;
           
           display: block;
           white-space: nowrap;
           overflow: hidden;
           text-overflow: ellipsis;
           max-width:200px;
           cursor:pointer;
        }
        .tab-container ul li.selected
        {
           border-right: none;
           background-color: #fff;
           border-left: 1px solid #169fe6;
		   
		   color:#169fe6;
        }
		
        .tab-container ul li:hover
        {
           border-left: 1px solid #169fe6;
        }
        .tab-container ul li a:hover
        {
           color: #000;
        }
        .main-container
        {
           margin: 0 0 0 199px;
           background-color: #fff;
           border: 1px solid #e0e0e0;
		   overflow-y:auto;
        }
		
		.main-container
		{
			bottom:60px;
			position:absolute;
			top:100px;
			bottom:60px;
			right:10px;
			left:10px;
		}
		
		.tab-container
		{
			position:absolute;
			bottom:60px;
			top:101px;
			right:0;
			left:10px;
		}
		
		.app-icon
		{
			float:left;
			margin-left:5px;
			margin-top:10px;
			margin-bottom:10px;
			width:16px;
			height:16px;
		}
		
		.app-info
		{
			float:left;
			text-align:left;
			width:155px;
			padding:5px;
			margin-left:5px;
		}
		
		.app-info p
		{
			width:130px;
			white-space: nowrap;
			overflow: hidden;
			text-overflow: ellipsis;
			line-height:25px;
		}
		
		.app-remove
		{
			position:absolute;
			margin-left:-4px;
			margin-top:8px;
			float: right;
		}
		
		.app-installed
		{
			display:inline-block;
			width:100%;
		}
		
		.app-installed:hover
		{
			background-color:#a0a0a0;
		}
		
		.app-installed .app-info
		{
			 width:90%;
		}
		
		:-ms-input-placeholder {
			/* Internet Explorer 10+ */
			color:    #999;
		}
		
		HTML, BODY
		{
		   scrollbar-face-color:#a0a0a0;
		   scrollbar-arrow-color:#ffffff;
		   scrollbar-track-color:#ffffff;
		   
		   scrollbar-shadow-color:rgb(160,160,160);
		   scrollbar-highlight-color:rgb(160,160,160);
		   scrollbar-3dlight-color:#f8f8f8;
		   scrollbar-darkshadow-Color:#f8f8f8;
		}
		
		.wiztitle
		{
			font-size:18px;
			white-space:normal;
		}
		
		html
		{
			font-family: GillSans, Calibri, Trebuchet, sans-serif;
		}
		
		fieldset .content
		{
			display: none;
		}
		
		#page1 legend
		{
			cursor:pointer;
		}
	 </style>
	 
     <link rel="stylesheet" type="text/css" href="css/jquery.tagsinput.css" />

  
    </head>

    <body style="border:1px solid #424242;background-color:#f3f3f3;">
	
    <!-- Window title -->
    <nav style="height:50px;padding:0">
    <div class="nav-wrapper titlebar grey darken-3" style="height:50px;padding:0">
	    <img src="out\\HostView.exe.ico" style="width:20px;height:20px;margin-left:10px;position:absolute;top:15px;"/>
        <span class="brand-logo titlebar" id="WindowTitle" style="margin-left:37px;width:100%;font-size:20px;line-height:50px;">
            Experience Questionnaire
        </span>	  
	    <a href="#" class="waves-effect waves-light right" style="margin-right:5px;margin-top:5px;height:50px;">
            <i onclick="OpenModal();" class="small mdi-navigation-close valign-wrapper" style="height:40px;"></i>
        </a>
    </div>
    </nav>  

    <div id="ButtonClose"></div>
        <!-- Modal Trigger -->
        <a class="modal-trigger" href="#modal-confirm-close" id="open-modal"></a>
        <!-- Modal Structure -->
        <div id="modal-confirm-close" class="modal">
        <div class="modal-content">
            <h4>Confirm close</h4>
            <p>Do you really want to close the questionnaire?</p>
        </div>
        <div class="modal-footer">
            <a href="#!" class=" modal-action modal-close waves-effect waves-red btn-flat" onclick="document.getElementById('ButtonClose').click();">OK</a>
	        <a href="#!" class=" modal-action modal-close waves-effect waves-green btn-flat">Cancel</a>
        </div>
    </div>
  
    <a class="modal-trigger" href="#modal-add-app" id="open-add-app"></a>
    <!-- Modal Structure -->
    <div id="modal-add-app" class="modal">
        <div class="modal-content">
            <h4>Add application</h4>
            <p>Select application:</p>
	        <div id="InstalledApps" style="height:170px;overflow-y:auto;"></div>
        </div>
        <div class="modal-footer">
	        <a href="#!" class=" modal-action modal-close waves-effect waves-red btn-flat" id="modal-add-app-cancel">Cancel</a>
        </div>
    </div>
  
    <div class="row" id="allui">

    <!-- Page 1: Activity Categories -->
    <div id="page1" class="hidden">
        <form class="col s12" style="height:100%;display:block;">

            <p class="wiztitle">For each of the applications below please report your activity.</p>

            <div>

                <div class="tab-container">
                    <!-- App List -->
                    <ul id="Categories"></ul>

                    <ul>
                        <li onclick="OpenAddApplication();" style="text-align:center">
                            <i class="mdi-content-add tiny" style="line-height:27px;color:#bcbcbc"></i>
                        </li>
                    </ul>

                </div> <!-- tab-container -->

                <div class="main-container" id="CategoriesContent">

                    <!-- Application specific section -->
                    <div class="input-field col s12">
                        <p>
                            What better describes the importance level of the activity you are doing at the moment with <b id="currAppName"></b> <span id="currAppExtra"></span>
                        </p>
                        <!--<p>What better describes your activity with <b id="currAppName"></b> <span id="currAppExtra"></span>
                    at the moment?</p> -->
                    </div>

                    <!--<div class="input-field col s12">

                    <div style="padding:5px;">
                        <input type="text" name="othertext" id="othertext" maxlength="32"
                            onkeyup="addlabel(event, 'othertext', 'categoriesfour');"
                            placeholder="please type your activity or click all that apply"/>
                    </div>

                    <div id="selections"></div>

                </div>-->
                    <div class="input-field col s12" style="padding-bottom:15px;margin-top:-5px;">

                        <fieldset>
                            <!-- <legend>
                            &nbsp;<i class="mdi-content-add" style="position:relative;top:1px;"></i>Importance Level &nbsp;
                        </legend>-->
                            <div id="appimportance"></div>
                        </fieldset>
                    </div>

                    <div class="input-field col s12">
                        <p>
                            What better describes your activity with <b id="currAppNameActivity"></b> <span id="currAppExtra"></span> (click all that apply)
                        </p>
                    </div>
                    <div class="input-field col s12" style="padding-bottom:15px;margin-top:-5px;">
                        <fieldset>
                            <!--<legend>
            &nbsp;<i class="mdi-content-add" style="position:relative;top:2px;"></i>&nbsp;Activity Type &nbsp;
        </legend>-->
                            <div id="appusefor"></div>
                            <div style="padding:2px;">
                                <!--onblur="InsertUserActivityTypeLabel()"-->
                                <input type="text" name="othertextuseractivity" id="othertextuseractivity" maxlength="32" onkeyup="InsertUserActivityTypeLabel(event)"  placeholder="If no category matches, manually type here a new one" />
                            </div>
                            <fieldset>
                                <legend>&nbsp;Other&nbsp;</legend>
                                <div id="appuseforuser"></div>
                            </fieldset>
                        </fieldset>

                    </div>

                    <div class="input-field col s12">
                        <p>
                            How would you rate the general performance of  <b id="currAppNameAppRate"></b> <span id="currAppExtra"></span> at the moment
                        </p>
                    </div>
                    <div class="input-field col s12" style="padding-bottom:15px;margin-top:-5px;">
                        <fieldset>
                            <div id="appperformance"></div>
                        </fieldset>
                    </div>


                    <div class="input-field col s12">
                        <p>
                            Did you experience any of the following problems with <b id="currAppNameSpecificIssue"></b> <span id="currAppExtra"></span> at the moment
                        </p>
                    </div>
                    <div class="input-field col s12" style="padding-bottom:15px;margin-top:-5px;">
                        <fieldset>
                            <div id="issues"></div>
                            <div style="padding:2px;">
                                <!--onblur="InsertUserActivityTypeLabel()"-->
                                <input type="text" name="othertextapissues" id="othertextapissues" maxlength="32" onkeyup="InsertUserAppIssuesLabel(event)" placeholder="If no category matches, manually type here a new one" />
                            </div>
                            <fieldset>
                                <legend>&nbsp;Other&nbsp;</legend>
                                <div id="issues_user"></div>
                            </fieldset>
                        </fieldset>
                    </div>




                    <!-- General - Computer-->
                    <div class="input-field col s12">
                        <p>
                            How would you rate the general performance of <b id="currAppNamePCPerf"></b> <span id="currAppExtra"></span> at the moment
                        </p>
                    </div>
                    <div class="input-field col s12" style="padding-bottom:15px;margin-top:-5px;">
                        <fieldset>
                            <div id="pcperformance"></div>
                        </fieldset>
                    </div>

                    <div class="input-field col s12">
                        <p>
                            Did you experience any of the following problems with <b id="currAppNameIssues"></b> <span id="currAppExtra"></span> at the moment
                        </p>
                    </div>
                    <div class="input-field col s12" style="padding-bottom:15px;margin-top:-5px;">
                        <fieldset>
                            <div id="pcissues"></div>
                            <div style="padding:2px;">
                                <!--onblur="InsertUserActivityTypeLabel()"-->
                                <input type="text" name="othertextpcissues" id="othertextpcissues" maxlength="32" onkeyup="InsertUserPcIssuesLabel(event)" placeholder="If no category matches, manually type here a new one" />
                            </div>
                            <fieldset>
                                <legend>&nbsp;Other&nbsp;</legend>
                                <div id="pcissues_user"></div>
                            </fieldset>

                        </fieldset>
                    </div>


                </div> <!-- main-container -->
            </div>
            </form>
</div> <!-- page1 -->

    <!-- Page 2: QoE Score -->
	<div id="page2" class="hidden">

	    <form style="position:absolute;top:60px;bottom:60px;right:10px;left:10px;">						
	    <p class="wiztitle">Please rate the performance of this computer at the moment.</p>

        <div class="input-field col s12" style="background:#ffffff;border:1px solid #e0e0e0;margin-top:0px;height:443px;text-align:center;">
            <div style="height:180px;"></div>								
            <p class="range-field">
                <input type="range" id="qoe" min="1" max="100" />
            </p>
								
		    <div id="labels" class="col s12" style="margin-top:-20px;margin-bottom:5px;">
			    <div class="col s2" style="text-align:left">
				    Poor
			    </div>									
			    <div class="col s8" style="text-align:center">
				    Good
			    </div>									
			    <div class="col s2" style="text-align:right">
				    Excellent
			    </div>
		    </div>
        </div>
		</form>
	</div> <!-- page2 -->


    <!-- Page 3: Issues -->
    <div id="page3" class="hidden">
    <div>
	    <p class="wiztitle">
            If you are experiencing problems with this computer at the moment, please report below. 
            Use the application tabs if problems are specific to a single application.
        </p>

        <div class="tab-container" style="top:131px;">
            <!-- App List -->
            <ul id="Issues">
            </ul>
        </div> <!-- tab-container -->

        <div class="main-container" style="top:130px;">
            <!-- Views -->
								
		    <div class="input-field col s12">
			    <p>
                    Did you experience any of the following problems with <span id="currAppOptional">the application</span>
                    <b id="currAppNameIssues"></b> <span id="currAppExtraIssues"></span> at the moment?
                </p>
		    </div>
								
		    <div  id="IssuesContent">
			    <div id="pc">
				    <!--
					    PC Part
				    -->
				    <div class="input-field col s12">
					    <div style="padding:5px;">
						    <input type="text" name="othertext" id="otherpcissue" maxlength="32" 
                                   onkeyup="addlabel(event, 'otherpcissue', 'pcissues');" 
                                   placeholder="please enter your problem or click all that apply"/>
					    </div>
				    </div>
											
				    <div class="input-field col s12">
					    <div id="pcissues">
					    </div>
				    </div>
			    </div>
									
			    <div id="apps">
				    <!--
					    Application Part
				    -->
				    <div class="input-field col s12">
					    <div style="padding:5px;">
						    <input type="text" name="othertext" id="otherissue" maxlength="32" 
                                   onkeyup="addlabel(event, 'otherissue', 'issues');" 
                                   placeholder="please enter your problem or click all that apply"/>
					    </div>
				    </div>

				    <div class="input-field col s12">
					    <div id="issues">
					    </div>
				    </div>
			    </div>
		    </div>
        </div> <!-- main-container -->
    </div>						
    </div> <!-- page3 -->

    <!-- navigation -->
    <div style="text-align:right; position:absolute;bottom:0px;right:10px;">
        <a href="#" class="waves-effect waves-grey btn-flat" id="ButtonBack" style="display:none" onclick="showPrevPage();">Back</a>
        <a href="#" class="waves-effect waves-light btn blue darken-1" id="ButtonNext" onclick="showNextPage();">Next</a>
        <a href="#" class="waves-effect waves-light btn blue darken-1" id="ButtonDone" style="display:none;">Submit</a>
    </div>
  
    </div> <!-- row -->
	
    <!--Import jQuery before materialize.js-->
    <script type="text/javascript" src="js/jquery-2.1.1.min.js"></script>
    <script type="text/javascript" src="js/materialize.min.js"></script>
    <script type="text/javascript" src="js/jquery.tagsinput.js"></script>

    <script type="text/javascript">			
        //--- Globals -----

        // navigation state
        var currPage = 0;
        var totalPages = 1;

        var currCatTab = null;
        var currIssueTab = null;

        // appId -> { name : "asd" , desc = "asd"} 
        var appInfo = { 'Computer': { name : 'computer', desc : 'computer' } };
        // c_appId -> { name => true|false }
        var appCats = {};
        // c_appId -> { name => true|false }
        var appIssues = { 'Computer': {} };
        // appId -> { name => true|false }
        var appPerformance = {};
        // appId -> { name => true|false }
        var appImportance = {};

		function showView(viewId, show) {
			document.getElementById(viewId).style.display = show == true ? "inline-block" : "none";
		}

		function showPage(pageNumber, show) {
			var page = document.getElementById('page' + pageNumber);
			if (page != undefined) {
				page.className = show ? 'visible' : 'hidden';
			}

			showView('ButtonBack', currPage > 1);
			showView('ButtonDone', currPage == totalPages);
			showView('ButtonNext', currPage < totalPages);
		}

		function showNextPage() {
			showPage(currPage, false);
			currPage++;
			showPage(currPage, true);
		}

		function showPrevPage() {
			showPage(currPage, false);
			currPage--;
			showPage(currPage, true);
		}

		function GetSelectedIndex(tabs) {
		    for (var i = 0; i < tabs.length; i++) {
		        if (tabs[i].className == "selected") return i;
		    }
		    return -1;
		}

		function SelectTab(container, tab) {
            // app tabs
		    var tabs = document.getElementById(container).getElementsByTagName('li');

            // clear previous
		    var prevIdx = GetSelectedIndex(tabs);
		    if (prevIdx > -1) {
		        tabs[prevIdx].className = "";
		    }

            // new selected app
		    tab.className = "selected";
		}

		function GetTabExtra(tab, container) {
		    document.getElementById(container).innerHTML = tab.getElementsByTagName("span")[0].innerHTML.length > 0 ? "(" + tab.getElementsByTagName("span")[0].innerHTML + ")" : "";
		}

		function SelectCategoriesTab(tab) {
		    if (tab != undefined) {
		        currCatTab = tab;
		        SelectTab('Categories', tab);

		        document.getElementById("currAppName").innerHTML = tab.getElementsByTagName("strong")[0].innerHTML;
		        GetTabExtra(tab, "currAppExtra");

		        document.getElementById("currAppNameActivity").innerHTML = tab.getElementsByTagName("strong")[0].innerHTML;
		        GetTabExtra(tab, "currAppExtra");

		        document.getElementById("currAppNameSpecificIssue").innerHTML = tab.getElementsByTagName("strong")[0].innerHTML;
		        GetTabExtra(tab, "currAppExtra");

		        document.getElementById("currAppNameAppRate").innerHTML = tab.getElementsByTagName("strong")[0].innerHTML;
		        GetTabExtra(tab, "currAppExtra");
		        
		        // restores the "selection" input content
		        var selectionImport = "";
		        for (var category in appCats[tab.id]) {
		            if (appCats[tab.id][category] == true) {
		                selectionImport += category + ", ";
		            }
		        }
		        $('#selections').importTags(selectionImport);
		        RestoreCatTags();
		    }
		}

		function SelectIssuesTab(tab) {
		    if (tab != undefined) {
		        currIssueTab = tab;
		        var computer = (tab.id == "Computer");

		        document.getElementById("pc").style.display = computer ? "block" : "none";
		        document.getElementById("apps").style.display = computer ? "none" : "block";

		        showView("currAppOptional", !computer);

		        SelectTab('Issues', tab);

		        document.getElementById("currAppNameIssues").innerHTML = tab.getElementsByTagName("strong")[0].innerHTML;
		        GetTabExtra(tab, "currAppExtraIssues");

		        document.getElementById("currAppNamePCPerf").innerHTML = tab.getElementsByTagName("strong")[0].innerHTML;
		        GetTabExtra(tab, "currAppExtra");

		        RestoreAppIssueTags();
		    }
		}

        // Called from EsmWizard.cpp on init
        // Show first page + make first items selected
		function SelectFirst() {
		    SelectCategoriesTab(document.getElementById('Categories').getElementsByTagName('li')[0]);
		    SelectIssuesTab(document.getElementById('Issues').getElementsByTagName('li')[0]);

		    currPage = 1;
		    showPage(currPage, true);
		}

        // called from EsmWizard.cpp
        function GetQoeScore() {
            return document.getElementById("qoe").value + "";
        }

        // called from EsmWizard.cpp
        function GetAppImportanceTags(appid) {
            var app = appInfo[appid];
            appid = 'c_' + appid;
            if (appImportance[appid]) {
                var tmp = []
                for (var k in appImportance[appid]) {
                    if (appImportance[appid][k] == true) tmp.push(k);
                }
                if (tmp.length > 0)
                    res = app.name + ';' + app.desc + ';' + tmp.join(',');

                return res;
            }
            return "";
        }

        function ClearPerformance(dict){
            for (var k in dict) {
                dict[k] = undefined;
            }
        }

        function GetAppPerformanceTags(appid) {
            var app = appInfo[appid];
            appid = 'c_' + appid;
            if (appPerformance[appid]) {
                var tmp = []
                for (var k in appPerformance[appid]) {
                    if (appPerformance[appid][k] == true) {tmp.push(k); }
                }
                if (tmp.length > 0)
                    res = app.name + ';' + app.desc + ';' + tmp.join(',');

                return res;
            }
            return "";
        }

        function GetPCPerformanceTags() {
            var appid = 'Computer';
            var app = appInfo['Computer'];
            if (appPerformance['Computer']) {
                var tmp = []
                for (var k in appPerformance[appid]) {
                    if (appPerformance[appid][k] == true) { tmp.push(k); }
                }
                if (tmp.length > 0)
                    res = app.name + ';' + app.desc + ';' + tmp.join(',');
                return res;
            }
            return "";
        }

        /*function GetNewPCIssuesTag() {
            appInfo['Computer']
            return app.name + ';' + app.desc + ';' + tmp.join(',');
            return document.getElementById("pcissues").value + ""; //TODO does it work in this way?
        }*/
    
        // called from EsmWizard.cpp
        // returns a comma-separated list of tags or empty string 
        // of the user activity tags for the given app
        function GetActivityTags(appid) {
            var app = appInfo[appid];
            appid = 'c_' + appid;

            var res = "";

            if (appCats[appid] && app) {
                var tmp = []
                for (var k in appCats[appid]) {
                    if (appCats[appid][k] == true) tmp.push(k);
                }
                if (tmp.length > 0)
                    res = app.name + ';' + app.desc + ';' + tmp.join(',');
            }

            return res;
        }

        // called from EsmWizard.cpp
        // returns a comma-separated list of tags or empty string 
        // of the user problem tags for the given app (if empty for the Computer)
        function GetProblemTags(appid) {
            var app = null;
            if (!appid || appid == "" || appid == 'Computer') {
                app = appInfo['Computer'];
                appid = 'Computer';
            } else {
                app = appInfo[appid];
                appid = 'c_' + appid;
            }

            var res = "";

            if (appIssues[appid] && app) {
                var tmp = []
                for (var k in appIssues[appid])
                    if (appIssues[appid][k] == true) tmp.push(k);
                if (tmp.length>0)
                    res = app.name + ';' + app.desc + ';' + tmp.join(',');
            }

            return res;
        }
			
        // called from EsmWizard.cpp
        function GetNewLabels(containerId) {
			var result = "";
				
            var spans = document.getElementById(containerId + "_tagsinput").getElementsByTagName('span');
				
            for (var i = 0; i < spans.length; i++) {
				var span = spans[i];
				if (span.className.indexOf("tag") == -1)
					continue;

				result += span.children[0].innerText.trim();
				result += ",";
			}
			return result.substring(0, result.length - 1);
		}
			
		// called from EsmWizard.cpp
		function GetNewCategories() {
		    return GetNewLabels('appusefor') + "," + GetNewLabels('appuseforuser');     // + ", " +  GetNewLabels('categoriesone') + ", " + GetNewLabels('categoriestwo') + ", " + GetNewLabels('categoriesthree') + ", " + GetNewLabels('categoriesfour');
		}

		// called from EsmWizard.cpp
		function GetNewIssues() {
		    return GetNewLabels('issues') + "," + GetNewLabels('issues_user');
		}

		// called from EsmWizard.cpp
		function GetNewPCIssues() {
		    return GetNewLabels('pcissues') + "," + GetNewLabels('pcissues_user');
		}

		// called from EsmWizard.cpp
		function GetPCPerformance() {
		    return GetNewLabels('pcperformance');
		}

		function GetAppImportance() {
		    return GetNewLabels("appimportance");
		}

		function GetAppPerformance() {
		    return GetNewLabels("appperformance");
		}

		
			
        // called from EsmWizard.cpp
		function AppendLabel(type, label) {
			var all = label.split(',');
			if (type == 'categories') {
				if (all.length > 16) {
					var result = all[15]; // shopping
					for (var i = 16; i < all.length; i ++) {
						result += ", " + all[i];
					}
					
					$("#categoriesfour").importTags(result);
				}
			} else if (all.length > 0 && label.length > 0) {
				$("#" + type).importTags(label);
			}
		}

		// Called from EsmWizard.cpp
		function ClearContainers() {
			var html = "";
			html += "				<ul>";
			html += "					<li id=\"Computer\" onclick=\"SelectIssuesTab(this);\">";
			html += "						<img class=\"app-icon\" src=\"out\\thispc.ico\" />";
			html += "						<div class=\"app-info\">";
			html += "							<p><strong>This Computer</strong></p>";
			html += "							<p><i></i></p>";
			html += "						</div>";
			html += "						<span></span>";
			html += "					</li>";
			html += "				</ul>";
			document.getElementById("Issues").innerHTML = html;
			document.getElementById("Categories").innerHTML = "";

            // reset all previous state(s)
			appInfo = { 'Computer': { name: 'computer', desc: 'computer' } };
			appCats = {};
			appIssues = { 'Computer': {} };
			appPerformance = {};
			appImportance = {};
		}
			
		function processName(app) {
			var result = app.replace(".exe", "");
			if (app.indexOf("www.") == 0) {
				result = app.replace("www.", "");
			}
			return result;
		}
			
		function RemoveElement(elemId) {
			var elem = document.getElementById(elemId);
			if (elem != undefined && elem != null) {
				elem.parentNode.removeChild(elem);
			}
		}

		function RemoveApplication(appId) {
			RemoveElement("c_" + appId);
			RemoveElement("c_" + appId);
				
			SelectCategoriesTab(document.getElementById('Categories').getElementsByTagName('li')[0]);
			SelectIssuesTab(document.getElementById('Issues').getElementsByTagName('li')[0]);

			appInfo[appId] = undefined;
			appCats["c_" + appId] = undefined;
			appIssues["c_" + appId] = undefined;
			appPerformance["c_"+appId] = undefined;
			appImportance["c_" + appId] = undefined;

        }

        // Called from EsmWizard.cpp
		function AppendApp(appId, appName, appDesc, appExtra) {
		    appInfo[appId] = { name: appName, desc: appDesc };

		    AppendAppCategories(appId, appName, appDesc, appExtra);
		    AppendAppIssues(appId, appName, appDesc, appExtra);
		}

		function AppendAppCategories(appId, appName, appDesc, appExtra) {
		    appCats['c_' + appId] = {};

		    var content = "<li id=\"c_" + appId + "\" onclick=\"SelectCategoriesTab(this);\">";
		    content += "<img class=\"app-icon\" src=\"out\\" + appName + ".ico\" />";
		    content += "<div class=\"app-info\"><p><strong>" + processName(appDesc != null && appDesc.length > 0 ? appDesc : appName) + "</strong></p></div>";
		    content += "<i class=\"tiny mdi-navigation-close app-remove\" onClick='RemoveApplication(\"" + appId + "\")'></i>"
		    content += "<span style=\"display:none\">" + appExtra + "</span>";
		    content += "</li>";

		    document.getElementById("Categories").innerHTML += content;
		}

		function AppendAppIssues(appId, appName, appDesc, appExtra) {
		    appIssues['c_' + appId] = {};

		    var content = "<li id=\"c_" + appId + "\" onclick=\"SelectIssuesTab(this);\">";
			content += "<img class=\"app-icon\" src=\"out\\" + appName + ".ico\" />";
			content += "<div class=\"app-info\"><p><strong>" + processName(appDesc != null && appDesc.length > 0 ? appDesc : appName) + "</strong></p></div>";
			content += "<span style=\"display:none;\">" + appExtra + "</span>";
			content += "</li>";

			document.getElementById("Issues").innerHTML += content;
		}
			
		// Called from EsmWizard.cpp
		function AppendInstalledApp(appId, appName, appDesc) {
			var content = "<div class=\"app-installed\" onclick=\"AddInstalledApplication(" + appId + ",'" + appName + "','" + appDesc + "');\">";
			content += "<img class=\"app-icon\" src=\"out\\" + appName + ".ico\" />";
			content += "<div class=\"app-info\"><p style=\"width:500px;\"><strong>" + appDesc + "</strong></p></div>";				
			content += "</div>";
				
			document.getElementById("InstalledApps").innerHTML += content;
		}
			
		function OpenAddApplication() {
			document.getElementById('open-add-app').click();
		}
			
		function AddInstalledApplication(appId, appName, appDesc) {
		    AppendApp(appId, appName, appDesc, "");
		    document.getElementById("modal-add-app-cancel").click();

		    var applist = document.getElementById('Categories').getElementsByTagName('li');
		    var isslist = document.getElementById('Issues').getElementsByTagName('li');
		    SelectCategoriesTab(applist[applist.length - 1]);
		    SelectIssuesTab(isslist[0]);
		}

		function escape(str) {
		    return str.split('"').join('\\"').split('\r\n').join('\\n').split('\n').join('\\n');
		}
			
		function OpenModal() {
			document.getElementById("open-modal").click();
		}


		function SetUserAppIssuesLabels(labelsAsString) {
		    $('#issues_user').importTags(labelsAsString);
		}
		
		function SetUserPcIssuesLabels(labelsAsString) {
		    $('#pcissues_user').importTags(labelsAsString);
		}

		function SetUserActivityLabels(labelsAsString) {
		    $('#appuseforuser').importTags(labelsAsString);
		}

		function RestoreAppIssueTags() {
		    $(".tag").each(function () {
		        if (String($(this).parent().attr('id')).indexOf("issues") >-1 &&
                    String($(this).parent().attr('id')).indexOf("pcissues") < 0) {

		            var text = $(this).children().first().text().trim();
		            $(this).attr('class', appIssues[currCatTab.id][text] == true ? 'tag active' : 'tag');
		        }
		    });
		}

        //todo this doesn't restore the categories anymore, we should change its name
		function RestoreCatTags() {
		    $(".tag").each(function () {
		        if (String($(this).parent().attr('id')).indexOf("pcissues") < 0 &&
                    String($(this).parent().attr('id')).indexOf("pcperformance") < 0) {
		            var text = $(this).children().first().text().trim();
		            var isPerformanceSet, isCategorySet, isImportanceSet, isIssuesSet = 0;

		            if (appPerformance[currCatTab.id])
		                isPerformanceSet = appPerformance[currCatTab.id][text] == true;

		            if (appCats[currCatTab.id])
		                isCategorySet = appCats[currCatTab.id][text] == true;

		            if (appImportance[currCatTab.id])
		                isImportanceSet = appImportance[currCatTab.id][text] == true;

		            if (appIssues[currCatTab.id]) {
		                isIssuesSet = appIssues[currCatTab.id][escape(text)] == true;
		            }
		            $(this).attr('class', isPerformanceSet | isCategorySet | isImportanceSet | isIssuesSet ? 'tag active' : 'tag');
                }		       
		    });
		}

		

        // handle predefined tag selection
        function OnClickSpan(span)
		{
	        if (span.parent().attr('id').indexOf("selections") > -1)
		        // ignore selections element
		        return;
		
            // tag text
	        var text = span.children().first().text().trim();
	        var selectedObj = span.parent().attr('id');
	        if (span.attr('class').indexOf("active") > -1) {
	            // tag deactivated
	            span.attr('class', 'tag');
	            if (span.parent().attr('id').indexOf("pcissues") > -1 /*|| span.parent().attr('id').indexOf("pcissues") > -1*/) {
	                appIssues['Computer'][escape(text)] = undefined;
	            } else if (span.parent().attr('id').indexOf("issues") > -1) {
	                appIssues[currCatTab.id][escape(text)] = undefined;
	            } else if (span.parent().attr('id').indexOf("appusefor") > -1 || span.parent().attr('id').indexOf("appuseforuser") > -1) {
	                appCats[currCatTab.id][text] = undefined;
	            } else if (span.parent().attr('id').indexOf("appperformance") > -1) {
	                appPerformance[currCatTab.id][text] = undefined;
	            } else if (span.parent().attr('id').indexOf("pcperformance") > -1) {
	                appPerformance['Computer'][text] = undefined;
	            } else if (span.parent().attr('id').indexOf("appimportance") > -1) {
	                appImportance[currCatTab.id][text] = undefined;
	            } else {
	                $('#selections').removeTag(text);
	            }
	        } else {
	            // activated
	            span.attr('class', 'tag active');
	            if (span.parent().attr('id').indexOf("pcissues") > -1 /*|| span.parent().attr('id').indexOf("pcissues") > -1*/) {
	                appIssues['Computer'][escape(text)] = true;
	            } else if (span.parent().attr('id').indexOf("issues") > -1 /*|| span.parent().attr('id').indexOf("pcissues") > -1*/) {
	                appIssues[currCatTab.id][escape(text)] = true;
	            } else if (span.parent().attr('id').indexOf("appperformance") > -1) {
	                if (!appPerformance[currCatTab.id])
	                    appPerformance[currCatTab.id] = {}
	                ClearPerformance(appPerformance[currCatTab.id]); //it can be one tag at the time only
	                appPerformance[currCatTab.id][text] = true; 
	            } else if (span.parent().attr('id').indexOf("pcperformance") > -1) {
	                if (!appPerformance['Computer'])
	                    appPerformance['Computer'] = {}
	                ClearPerformance(appPerformance['Computer']); //it can be one tag at the time only
	                appPerformance['Computer'][text] = true;
	            } else if (span.parent().attr('id').indexOf("appimportance") > -1) {
	                if (!appImportance[currCatTab.id])
	                    appImportance[currCatTab.id] = {}
	                appImportance[currCatTab.id][text] = true;
	            } else if (span.parent().attr('id').indexOf("appusefor") > -1 || span.parent().attr('id').indexOf("appuseforuser") > -1) {
	                if (!appCats[currCatTab.id])
	                    appCats[currCatTab.id] = {}
	                appCats[currCatTab.id][text] = true;

	            } else {
	                $('#selections').addTag(text);
	            }
	            result = text;
	        }
	        if (String(selectedObj).indexOf("issue") < 0) {
	                RestoreClass(selectedObj);
	        }
	       // RestoreCatTags();
        }

        function RestoreClass(id) {

            $(".tag").each(function () {
                var text = $(this).children().first().text().trim();
                var objIndex = $(this).parent().attr('id');

                if (objIndex == id ||
                    (String(objIndex).indexOf("usefor") > -1 && String(id).indexOf("usefor") > -1))  //TODO this is quite ugly. fix it!
                    $(this).attr('class', result == text ? 'tag active' : 'tag');
            });
        }
	
        // handle user defined tag addition
	    function addlabel(e, inputid, container) {
		    var charCode = (typeof e.which === "number") ? e.which : e.keyCode;		
		    if (charCode == 13) {
                // tag text
		        var text = document.getElementById(inputid).value;
		        document.getElementById(inputid).value = "";

		        if (container.indexOf('issues') > 0) {
		            // add new issue
		            if (!$('#' + container).tagExist(text))
    		            $('#' + container).addTag(text);
		            appIssues[currIssueTab.id][escape(text)] = true;
		            RestoreAppIssueTags();
		        } else {
                    // add new activity
		            if (!$('#' + container).tagExist(text))
		                $('#' + container).addTag(text);
		            showCat($('#' + container).parent(), false);
		            $('#selections').addTag(text);
                }
		    }
	    }
	
	    $(function () {
	        function initTagInput(inputId) {
	            $("#" + inputId).tagsInput({
	                width: 'auto',
	                removeWithBackspace: false,
	                defaultText: 'enter another activity',
	                height: '0px',
	                interactive: false,
	                unique: true,
	                onChange: function (elem, tag) {
	                    $(".tag").unbind().click(function () {
	                        OnClickSpan($(this));
	                    });
	                }
	            });
	        }

		    initTagInput('categoriesone');
		    initTagInput('categoriestwo');
		    initTagInput('categoriesthree');
		    initTagInput('categoriesfour');

		    initTagInput('appuseforuser');
		    initTagInput('issues_user');
		    initTagInput('pcissues_user');


		    initTagInput('issues');
		    initTagInput('pcissues');

		    initTagInput('pcperformance');
		    initTagInput('appperformance');
		    initTagInput('appimportance');
		    initTagInput('appusefor');
		
            // This is the list of selected activities
		    $("#selections").tagsInput({
			    width: 'auto',
			    removeWithBackspace:false,
			    defaultText:'enter another activity',
			    height: '0px',
			    interactive:false,
			    unique:true,

			    onAddTag: function(tag) {
			        appCats[currCatTab.id][tag] = true;
			        RestoreCatTags();
			    },

			    onRemoveTag: function(tag) {
                    appCats[currCatTab.id][tag] = undefined;
                    RestoreCatTags();
			    }
		    });
        });
	
	    function showCat(contentElem, toggle) {
		    var visible = true;
		    if (!contentElem.is(':visible')) {
			    $('.content').hide();
			    contentElem.slideToggle();
		    } else if (toggle) {
			    visible = false;
			    contentElem.slideToggle();
		    }
		
		    contentElem.parent().parent().parent().find('i').attr('class', 'mdi-content-add');
		    contentElem.parent().find('i').attr('class', visible ? 'mdi-content-remove' : 'mdi-content-add');
	    }
	
	    $(function(){
		    $('legend').click(function(){			
			    showCat($(this).parent().find('.content'), true);
		    });
	    });
	
	    function showForthLegend(e) {	
		    var charCode = (typeof e.which === "number") ? e.which : e.keyCode;		
		    if (charCode == 13) {
		    }
	    }

	    function InsertUserAppIssuesLabel(e) {
	        if (e != undefined) {
	            var charCode = (typeof e.which === "number") ? e.which : e.keyCode;
	            if (charCode != 13)
	                return;
	        }
	        var value = document.getElementById('othertextapissues').value;

	        if (value != null && value != undefined && value.length > 0) {
	            $('#issues_user').addTag(value, { 'unique': true });
	            document.getElementById('othertextapissues').value = "";
	        }
	    }

	    function InsertUserPcIssuesLabel(e) {
	        if (e != undefined) {
	            var charCode = (typeof e.which === "number") ? e.which : e.keyCode;
	            if (charCode != 13)
	                return;
	        }
	        var value = document.getElementById('othertextpcissues').value;

	        if (value != null && value != undefined && value.length > 0) {
	            $('#pcissues_user').addTag(value, { 'unique': true });
	            document.getElementById('othertextpcissues').value = "";
	        }
	    }

	    function InsertUserActivityTypeLabel(e) {
	        if (e != undefined) {
	            var charCode = (typeof e.which === "number") ? e.which : e.keyCode;
	            if (charCode != 13)
	                return;
	        }

	        var value = document.getElementById('othertextuseractivity').value;

	        if (value != null && value != undefined && value.length > 0) {
	            $('#appuseforuser').addTag(value, { 'unique': true });
	            document.getElementById('othertextuseractivity').value = "";
	        }
	    }

	    function GetResult() { //GG do we need this?
	        InsertUserActivityTypeLabel();
	        return result;
	    }

	    $(document).ready(function() {
	        // the "href" attribute of .modal-trigger must specify the modal ID that wants to be triggered
	        $('.modal-trigger').leanModal();

            // Default activity tags
	        $('#categoriesone').importTags("News & Weather, Education & Learning, Reviews & listings, Public & Commercial Services");
		    $('#categoriestwo').importTags("Video streaming, Music, Books & Magazines, Games, Images & Photos, Hobbies");
		    $('#categoriesthree').importTags("Email, Video & voice call, Social Media, Chat, Blogs");
		    $('#categoriesfour').importTags("Shopping & Selling, Banking & finance, Cloud storage, Computer management, Media downloads, Utilities, Calendars, Maps, Web searches");


		    $('#appusefor').importTags("Work, Education, Personal Task, Leisure");



		    $('#pcperformance').importTags("Very Poor, Poor, Fair, Good, Very Good");
		    $('#appperformance').importTags("Very Poor, Poor, Fair, Good, Very Good");

		    $('#appimportance').importTags("Not important, Not very important, Important, Very Important, Critical");


            // Default 'Computer' issues
		    $('#pcissues').importTags("No connection,Frequent disconnections, Slow connection, Slow computer");

            // Default App issues
		    $('#issues').importTags("Application can't connect, Application keeps disconnecting, Application is slow, Poor voice or audio quality,Poor video quality");

		    $(window).focus();
	    });

        // some test content - just here if this html is opened in the browser for testing .. EsmWizard.cpp will reset all this
	    ClearContainers();
	    AppendApp("1", "chrome.exe", "Chrome", "");
    	AppendApp("2", "www.google.com", "www.google.com", "Extra");
    	SelectFirst();

    </script>
    </body>
  </html>